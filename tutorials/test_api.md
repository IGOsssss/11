<md-hidden>
üõë –î–∞–Ω–Ω—ã–π —Ç—É—Ç–æ—Ä–∏–∞–ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ GitHub üî¥ –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! –≠—Ç–æ –ª–∏—à—å –∏—Å—Ö–æ–¥–Ω–∏–∫.<br>
–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è https://www.epic1h.com/test_api
</md-hidden>

# –¢—É—Ç–æ—Ä–∏–∞–ª: —Ç–µ—Å—Ç–∏—Ä—É–µ–º API –≤ Cypress

–ü–æ–¥–æ–π–¥–µ—Ç —Ç–µ–º, –∫—Ç–æ —Ö–æ—á–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å HTTP –∑–∞–ø—Ä–æ—Å—ã –≤ Cypress.

# üëç –ß—Ç–æ —Å–¥–µ–ª–∞–µ–º

* –ù–∞—É—á–∏–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Swagger –∏ Postman.
* –ù–∞—É—á–∏–º—Å—è –¥–µ–ª–∞—Ç—å –ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API.
* –ù–∞—É—á–∏–º—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã API –±–µ–∫–µ–Ω–¥–∞ –≤ Cypress.

# üòç –ñ–∏–≤–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

<import from="/partials/zoom_standups.md"></import>

# üí™ –ú–∏–Ω—É—Ç–∫–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏

–ê –¥–ª—è –ø–æ–¥–Ω—è—Ç–∏—è –±–æ–µ–≤–æ–≥–æ –¥—É—Ö–∞ –≤–æ—Ç üëá

<iframe width="800" height="450" src="https://www.youtube.com/embed/60ZVdodaoUU?start=5" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

***

# üî¢ –®–∞–≥–∏

## +1. –ò—â–µ–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∞ API

–î–∞ –¥–∞, –∏ —Å–Ω–æ–≤–∞ —Ç–≤–æ–π –ª—é–±–∏–º—ã–π [Conduit](https://demo.realworld.io/)

- [x] –û—Ç–∫—Ä–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ [GitHub](https://github.com/gothinkster/realworld)
- [x] –ù–∞–π–¥–∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é: **View our starter guide & spec**
- [x] –í —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–π–¥–∏ –≤ —Ä–∞–∑–¥–µ–ª: **Frontend ‚Üí API**
- [x] –í –¥–æ–∫—É–º–µ–Ω—Ç–µ –Ω–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª: **Swagger documentation**
- [x] –û—Ç–∫—Ä–æ–π Swagger UI [https://api.realworld.io/api-docs](https://api.realworld.io/api-docs)

* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ Swagger?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ Open API?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ Swagger UI?
* ‚ùì –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ API?

***

## +2. –ò–≥—Ä–∞–µ–º—Å—è –≤ Swagger UI

- [x] –í Swagger UI –Ω–∞–π–¥–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç `GET /articles`
- [x] –ù–∞–∂–º–∏ **Try it out** –∏ **Execute**

<details>
  <summary>–í–æ—Ç —Ç–∞–∫ –≤–æ—Ç üìπ</summary>

<img class="cornered" alt="–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Swagger" 
     width="800" height="354" src="assets/test_api/try_swagger_ui.gif">
</details>

* ‚ùì –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ?
* ‚ùì –ß—Ç–æ —Ç—ã –≤–∏–¥–∏—à—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ **Request URL**?
* ‚ùì –ö–∞–∫–æ–π —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∞–ª —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ **Curl**?

***

- [x] –û—Ç–∫—Ä–æ–π –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ https://api.realworld.io/api/articles?limit=10&offset=0
- [x] –í—ã–ø–æ–ª–Ω–∏ –¥–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤ Postman.

<details>
  <summary>–í–æ—Ç —Ç–∞–∫ –≤–æ—Ç üñºÔ∏è</summary>

<img class="cornered" alt="GET –∑–∞–ø—Ä–æ—Å –≤ Postman" 
     width="800" height="637" src="assets/test_api/xhr_in_postman.png">

</details>

* ‚ùì –ó–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `limit=10` –∏ `offset=0`?

***

- [x] –û—Ç–∫—Ä–æ–π https://demo.realworld.io/
- [x] –ù–∞–π–¥–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞ —ç—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

<details>
  <summary>–í–æ—Ç —Ç–∞–∫ –≤–æ—Ç üñºÔ∏è</summary>

<img class="cornered" alt="XHR –∑–∞–ø—Ä–æ—Å –≤ Dev Tools" 
     width="800" height="361" src="assets/test_api/xhr_in_dev_tools.png">

</details>

* ‚ùì –ß—Ç–æ —Ç—ã –≤–∏–¥–∏—à—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ?
* ‚ùì –ì–¥–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ?

***

## +3. –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–∞ API

**API** ‚Äì –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏. 

```mermaid
sequenceDiagram
    Program A ->> Program B: How interact?
```

–ü—Ä–æ–≥—Ä–∞–º–º–∞ `A` —Ö–æ—á–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É `XYZ` —É –ø—Ä–æ–≥—Ä–∞–º–º—ã `B`

```mermaid
sequenceDiagram
    Program A ->> Program B: Call procedure XYZ(param 1, param 2, ...)
    Program B ->> Program A: Return results
    Note over Program A, Program B: How to do that?
```

**–§—Ä–æ–Ω—Ç–µ–Ω—Ç** ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–Ω–∞—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –≤ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–µ, **–ë–µ–∫–µ–Ω–¥** ‚Äî –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ.

```mermaid
sequenceDiagram
    Front-end ->> Back-end: Request /articles
    Back-end ->> Front-end: Response
    Note over Front-end, Back-end: API over HTTP over TCP/IP
```

–ù–∞–º–æ—Ç–∞–π –Ω–∞ üòÖ —É—Å:
* **TCP/IP** ‚Äî –Ω—É–∂–µ–Ω —Ç.–∫. –ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞–ø—É—â–µ–Ω—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö.
* **HTTP** ‚Äî –ø–æ—Ç–æ–º—É, —á—Ç–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä –∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.

**HTTP –¥–ª—è API** ‚Äî —è–∑—ã–∫ –æ–±—â–µ–Ω–∏—è (—Å–ª–æ–≤–∞), –ø—Ä–∞–≤–∏–ª–∞ –æ–±—â–µ–Ω–∏—è (–∫–∞–∫ –ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞) ‚Äî –∫–æ–Ω—Ç—Ä–∞–∫—Ç.

<mark>–ó–∞–ø–æ–º–Ω–∏ ‚Üí API = —Å–ø–æ—Å–æ–± + –ø—Ä–∞–≤–∏–ª–∞ –æ–±—â–µ–Ω–∏—è</mark>

–ö–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç [–º–æ–π –æ–ø—ã—Ç](https://habr.com/ru/post/599127/), –¥–∞–∂–µ –∑—Ä–µ–ª—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–Ω–∏–º–∞—é—Ç, —á—Ç–æ —Ç–∞–∫–æ–µ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–∞ API.**

> –ú–Ω–æ–≥–∏–µ –¥—É–º–∞—é—Ç, —á—Ç–æ Swagger (Open API) ‚Äì —ç—Ç–æ ¬´UI —à–∫—É—Ä–∫–∞¬ª, –∫–æ—Ç–æ—Ä—É—é –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±–µ–∫–µ–Ω–¥.
> 
> –ù–æ Open API —ç—Ç–æ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å ‚Äì [JSON —Å—Ö–µ–º–∞](https://github.com/OAI/OpenAPI-Specification/blob/main/schemas/v3.0/schema.yaml) –æ–ø–∏—Å–∞–Ω–∏—è API.

***

- [x] –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–∞ API –¥–ª—è –±–µ–∫–µ–Ω–¥–∞ [Conduit](https://github.com/gothinkster/realworld/blob/main/api/openapi.yml)
- [x] –°–∫–æ–ø–∏—Ä—É–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä Swagger https://editor.swagger.io/
- [x] –ù–∞–π–¥–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `GET /articles`
- [x] –î–æ–±–∞–≤—å –Ω–æ–≤—ã–π `query` –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ `YAML` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:

```yaml
- name: sorting
  in: query
  description: How to sort results
  required: false
  schema:
    type: string
    default: 'by_date_desc'
    enum:
        - 'by_date_desc'
        - 'mostly_liked'
```
- [x] –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ Swagger UI –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Ä–∞–∑–∏–ª—Å—è.

<details>
  <summary>–í–æ—Ç —Ç–∞–∫ –≤–æ—Ç üñºÔ∏è</summary>

<img class="cornered" alt="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ API" 
     width="1043" height="187" src="assets/test_api/add_sorting.png">

</details>

* ‚ùì –ö–∞–∫ –±—ã–ª —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `openapi.yml`?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `YAML`?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `required`?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `default`?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `enum`?
* ‚ùì –ß—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å `sorting`?
* ‚ùì –ú—ã —É–∂–µ –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É?

***

- [x] –ù–∞–π–¥–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –¥–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å.
- [x] –ü—Ä–æ–∏–Ω—Å–ø–µ–∫—Ç–∏—Ä—É–π –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö.
- [x] –ù–∞–π–¥–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ `Articles` –≤ `YAML`

<details>
  <summary>–í–æ—Ç —Ç–∞–∫ –≤–æ—Ç üìπ</summary>

<img class="cornered" alt="–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Swagger" 
     width="670" height="605" src="assets/test_api/articles_response.gif">
</details>

- [x] –î–æ–±–∞–≤—å –≤ **DTO** `Articles` –Ω–æ–≤–æ–µ –ø–æ–ª–µ `commentsCount`
- [x] –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ Swagger UI –∫–æ–Ω—Ç—Ä–∞–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω.

* ‚ùì –ö–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –±—É–¥–µ—Ç –ø–æ–ª–µ?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ DTO?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `$ref` –≤ YAML?

```markdown quiz have_we_comments_count horizontal
‚ùì –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —ç—Ç–æ –ø–æ–ª–µ —É–∂–µ –ø–æ—è–≤–∏–ª–æ—Å—å?

- [ ] –î–∞
- [x] –ù–µ—Ç


–ö–æ–Ω–µ—á–Ω–æ **–Ω–µ—Ç!** –ú—ã —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–∏–ª–∏ –ø–æ–ª–µ –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç.

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –∏–¥—Ç–∏ –∫ –±–µ–∫–µ–Ω–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –∏:
1. **—Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å** –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ,
2. –¥–æ–∂–¥–∞—Ç—å—Å—è **–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** –∫–æ–¥–∞ –±–µ–∫–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
```

***

## +4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–Ω–¥–ø–æ–π–Ω—Ç–∞

- [x] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π —á–∏—Å—Ç—ã–π –ø—Ä–æ–µ–∫—Ç `%/projects/cypress/test_api`
- [x] –î–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Ç–µ—Å—Ç–∞ `test-api.spec.js` —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```js
///<reference types="cypress" />
import { getRandomNumber } from '/cypress/support/utils';

const BACKEND_BASE_URL = 'https://api.realworld.io/api';
const DEFAULT_BASE_URL = Cypress.config('baseUrl');

before(() => {
    cy.log('set base url to backend');
    Cypress.config('baseUrl', BACKEND_BASE_URL);
});

after(() => {
    cy.log('reset base url');
    Cypress.config('baseUrl', DEFAULT_BASE_URL);
});

describe('API', () => {

    describe('Articles', () => {

        it('should do retrieve articles list', () => {

            cy.request('GET', '/api/articles')
                .then(({ status, body }) => {
                    debugger;

                    // checking HTTP status
                    expect(status).to.eq(201);

                    // checking base response
                    expect(body).to.have.all.keys('articles', 'articlesCount');

                    // checking random article
                    const rnd = getRandomNumber(0, 9);
                    cy.log(`checking ${rnd} article`);
                    const article = body.articles[rnd];
                    expect(article).to.have.all.keys(
                        'slug',
                        'title',
                        'createdAt',
                        'author',
                        'description',
                        'tagList',
                        'body',
                        'favorited',
                        'favoritesCount',
                        'updatedAt'
                    );
                    expect(article.slug).to.not.be.empty;
                    expect(article.title).to.not.be.empty;
                    expect(article.createdAt).to.not.be.empty;
                    expect(article.author).to.not.be.empty;
                    expect(article.description).to.not.be.empty;
                    expect(article.body).to.not.be.empty;

                    expect(article.favorited).to.be.a('boolean');
                    expect(article.favoritesCount).to.be.a('number');

                    // checking author
                    const { author } = article;
                    expect(author).to.have.all.keys('bio', 'following', 'image', 'username');
                    expect(author.following).to.be.a('boolean');

                    expect(author.username).to.not.be.empty;
                    expect(author.image).to.match(/^https/);
                });

        });

    });

});
```

- [x] –°–¥–µ–ª–∞–π —Ç–∞–∫, —á—Ç–æ –±—ã —Ç–µ—Å—Ç üü¢ –∑–∞—Ä–∞–±–æ—Ç–∞–ª.

<mark>–°—Ä–∞–∑—É —Ö–æ—á–µ—à—å —Å–±–µ–∂–∞—Ç—å –≤ –ø–æ–¥—Å–∫–∞–∑–∫–∏ ü§®? –°–∫—É—á–Ω–æ?</mark>

–ù–∞ —Ä–∞–±–æ—Ç–µ —Ç—ã **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ** –±—É–¥–µ—à—å —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å **–Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–º –∫–æ–¥–æ–º** ‚Äì —ç—Ç–æ –≤–∞–∂–Ω—ã–π –Ω–∞–≤—ã–∫.

<details>
  <summary>–ß—Ç–æ –¥–µ–ª–∞—Ç—å?</summary>

- [x] –ò—Å–ø—Ä–∞–≤—å –∞–¥—Ä–µ—Å –µ–Ω–¥–ø–æ–π–Ω—Ç–∞:

```diff
- cy.request('GET', '/api/articles')
+ cy.request('GET', '/articles')
```

- [x] –ò—Å–ø—Ä–∞–≤—å –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞:

```diff
- expect(status).to.eq(201)
+ expect(status).to.eq(200)
```

- [x] –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `~/cypress/support/utils.js`

```js
export function getRandomNumber(min, max) {
    return Math.round(Math.random() * (max - min)) + min;
}
```
</details>

***

* ‚ùì –ó–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç `Cypress.config`?
* ‚ùì –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Ö—É–∫–∏ `before` –∏ `after`?
* ‚ùì –í –∫–∞–∫–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∏ –±—ã –Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å?

***

## +5. –ò–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç API

–ê —Å–µ–π—á–∞—Å, —è –µ—â–µ **—Å—ç–∫–æ–Ω–æ–º–ª—é —Ç–µ–±–µ –∫—É—á—É –≤—Ä–µ–º–µ–Ω–∏** –≤ –±—É–¥—É—â–µ–º!

- [x] –û—Ç–∫—Ä–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ –°ypress.
- [x] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç.
- [x] –ü—Ä–æ–∏–Ω—Å–ø–µ–∫—Ç–∏—Ä—É–π –∫–æ–¥ —Ç–µ—Å—Ç–∞ –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ.

<video class="cornered" width="600px" controls>
  <source src="assets/test_api/use_debugger.mp4" type="video/mp4">
</video>

* ‚ùì –ß—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å `debugger` –≤ –∫–æ–¥–µ?

***

## +6. –°hai.js

`expect` ‚Äì —ç—Ç–æ **—Å—É–ø–µ—Ä —Ñ—É–Ω–∫—Ü–∏—è** –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π **–°hai.js** –∫–æ—Ç–æ—Ä—É—é –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è Cypress.

‚ùì –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ **—Å—É–ø–µ—Ä —Ñ—É–Ω–∫—Ü–∏—è**?

- [x] –£—Å—Ç–∞–Ω–æ–≤–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `npm install chai --save-dev`
- [x] –î–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª `~/js_examples/chai.js` —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```js
const { expect } = require('chai');

const article = {
    slug: null,
    title: null,
    createdAt: '2022-12-01',
    description: null,
    body: null,
    favorited: 1,
    favoritesCount: '5',
    updatedAt: null
};

expect(article).to.have.all.keys(
    'slug',
    'title',
    'createdAt',
    'description',
    'tagList',
    'body',
    'favorited',
    'favoritesCount',
    'updatedAt'
);

const DATE_FORMAT = /^\d{2}\-\d{2}\-\d{4}$/;

expect(article.slug).to.not.be.empty;
expect(article.title).to.not.be.empty;
expect(article.createdAt).to.not.be.empty;
expect(article.createdAt).match(DATE_FORMAT, 'wrong created at date format');
expect(article.description).to.not.be.empty;
expect(article.tagList).to.be.instanceof(Array);
expect(article.tagList).have.length.greaterThan(2);
expect(article.favorited).to.be.a('boolean');
expect(article.favoritesCount).to.be.a('number');
expect(article.updatedAt).match(DATE_FORMAT, 'wrong updated at date format');
```

- [x] –ó–∞–ø—É—Å—Ç–∏ —Ñ–∞–π–ª `node js_examples/chai.js`
- [x] –û–∑–Ω–∞–∫–æ–º—å—Å—è —Å [API](https://www.chaijs.com/api/bdd/) –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
- [x] –ò—Å–ø—Ä–∞–≤—å –∫–æ–¥, —á—Ç–æ –±—ã —Ñ–∞–π–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.

***

- [x] –ü—Ä–∏–≤–µ–¥–∏ —Å–≤–æ–π –∫–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å [—ç—Ç–∞–ª–æ–Ω–æ–º](/js_examples/chai.js)

## +7. –¢–µ—Å—Ç API —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 7.1. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç

- [x] –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–∞ –µ–Ω–¥–ø–æ–π–Ω—Ç `POST /users`
- [x] –í—ã–ø–æ–ª–Ω–∏ –≤ Postman –∑–∞–ø—Ä–æ—Å —Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π (payload):

```json
{ "user": { "username": "?", "email": "?", "password": "?" } }
```

- [x] –ù–∞–ø–∏—à–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- [x] –ò—Å–ø–æ–ª—å–∑—É–π `faker` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.

***

- [x] –ü—Ä–∏–≤–µ–¥–∏ —Å–≤–æ–π –∫–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å [—ç—Ç–∞–ª–æ–Ω–æ–º](/cypress/integration/test-api.spec.js#L73)

* ‚ùì –ó–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ–ª–µ `token` –≤ –æ—Ç–≤–µ—Ç–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞?

***

### 7.2. –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç

–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç –∫–µ–π—Å—ã –±–∞–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. 

> **–¶–µ–ª—å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –≤–≤–æ–¥ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

- [x] –í—ã–ø–æ–ª–Ω–∏ —á–µ—Ä–µ–∑ Postman –∑–∞–ø—Ä–æ—Å:

```text
POST https://api.realworld.io/api/users
{ "user": { "username": "", "email": "", "password": "" } }
```

* ‚ùì –ö–∞–∫–æ–π –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—É—á–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞?
* ‚ùì –ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞?

***

- [x] –î–æ–±–∞–≤—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç:

```js
it.only('should not do register user with empty data', () => {

    const payload = {
        user: { username: '', email: '', password: '' }
    };

    cy.request({ method: 'POST', url: '/users', body: payload, failOnStatusCode: false })
        .then(({ status, body }) => {
            expect(status).to.eq(422);
            expect(body).to.have.key('errors');
            const {errors} = body;
            expect(errors).to.have.key('email');
            const {email} = errors;
            expect(email).to.have.lengthOf(1);
            const message = email.join('');
            expect(message).to.have.eq('can\'t be blank');
        });

});
```

* ‚ùì –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç?
* ‚ùì –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `failOnStatusCode`?
* ‚ùì –ó–∞—á–µ–º –≤ –∫–æ–¥–µ –¥–µ–ª–∞—Ç—å `join`?
* ‚ùì –ö–∞–∫–∏–µ –µ—â–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ –¥–∞–Ω–Ω—ã–π –µ–Ω–¥–ø–æ–π–Ω—Ç?

***

## +8. –õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API

`cy.request` –≤ –°ypress –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API, –Ω–æ –∏ –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á.

–í—Å–ø–æ–º–Ω–∏ [—Å–≤–æ–π –∫–æ–¥](cypress/integration/finish_mama_project/articles/crud.spec.js) –∏–∑ —Ç—É—Ç–æ—Ä–∏–∞–ª–∞ [–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –º–∞–º–∞ –ø—Ä–æ–µ–∫—Ç](@finish_mama_project)

–ü–µ—Ä–µ–¥ –≤—Å–µ–º–∏ —Ç–µ—Å—Ç–∞–º–∏ —Ç—Ä–µ–±—É—é—â–∏–º–∏ **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Ç—ã –ø–æ–≤—Ç–æ—Ä—è–ª **—à–∞–≥–∏ –≤—Ö–æ–¥–∞**, —Ñ—É–Ω–∫—Ü–∏—è ‚Äì `login()`

**–ß—Ç–æ, –µ—Å–ª–∏ –±—ã —Ç—ã –º–æ–≥:**
* –ø—Ä–æ–π—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é 1 —Ä–∞–∑ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ API,
* –ø–æ–ª—É—á–∏—Ç—å **JWT** —Ç–æ–∫–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞,
* –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º `cy.visit` –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä?

- [x] –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–∞ –µ–Ω–¥–ø–æ–π–Ω—Ç `POST /users/login`
- [x] –í—ã–ø–æ–ª–Ω–∏ –≤ Postman –∑–∞–ø—Ä–æ—Å —Å –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π (payload) –∏ –ø–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω:

```text
‚Üì Request
POST https://api.realworld.io/api/users/login
{ "user": { "email": "?", "password": "?" } }

‚Üì Response
{
  "token": "XYZ"
}
```

`XYZ` ‚Äì —ç—Ç–æ —Ç–æ–∫–µ–Ω –¥–ª—è —Ç–≤–æ–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

- [x] –ó–∞–π–¥–∏ –Ω–∞ https://demo.realworld.io/
- [x] –ï—Å–ª–∏ —Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, —Ç–æ –≤—ã–π–¥–∏.
- [x] –í DevTools –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —É—Å—Ç–∞–Ω–æ–≤–∏ `jwtToken=XYZ`

* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `JWT` —Ç–æ–∫–µ–Ω?
* ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ `local storage` –≤ –±—Ä–∞—É–∑–µ—Ä–µ?
* ‚ùì –ß–µ–º `local storage` –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–µ—á–µ–Ω–µ–∫?
* ‚ùì –í –∫–∞–∫–æ–º HTTP –∑–∞–≥–æ–ª–æ–≤–∫–µ —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä?
* ‚ùì –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ª—É—á—à–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –∫–∞–∂–¥—ã–π —Ä–∞–∑?

***

- [x] –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ –ø—Ä–æ–µ–∫—Ç `finish_mama_project`
- [x] –î–æ–±–∞–≤—å –≤ —Ñ–∞–π–ª `~/cypress/support/index.js`

```js
///<reference types="cypress" />
import meUser from '/cypress/fixtures/me-user.json';

before(() => {
    const { email, password } = meUser;
    cy.request('POST', 'https://api.realworld.io/api/users/login',
        { user: { email, password } })
        .then(({ status, body }) => {
            expect(status).to.eq(200);
            expect(body).to.have.key('user');
            const { user } = body;
            cy.writeFile('token.txt', user.token);
        });
});
```

- [x] –î–æ–±–∞–≤—å –≤ —Ñ–∞–π–ª `~/cypress/support/utils.js`

```js
export function setJwtToken(window, token) {
    window.localStorage.setItem('jwtToken', token);
}
```

- [x] –í –∫–∞–∂–¥–æ–º —Ç–µ—Å—Ç–µ –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:

```js
import meUser from '/cypress/fixtures/me-user.json';
import { setJwtToken } from '/cypress/support/utils';

it('should do publish article', () => {
  
  cy.readFile('token.txt')
    .should('not.be.empty')
    .then(token => {
        cy.visit('/', {
            onBeforeLoad: (window) => setJwtToken(window, token)
        });
    });
  cy.get('.navbar').should('be.visible')
    .should('contain.text', meUser.username);

  // test body here

});
```

***

- [x] –í—ã–ø–æ–ª–Ω–∏ –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ –≤ Headless.

* ‚ùì –í–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É—Å–∫–æ—Ä–∏–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ?

***

## +9. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ API –∑–∞–ø—Ä–æ—Å–∞—Ö

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API —Ñ–∏—á–µ–π, —Ç—Ä–µ–±—É—é—â–∏—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–∞–∫ –∂–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞.

**–¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ HTTP –∑–∞–ø—Ä–æ—Å–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º –∑–∞–≥–æ–ª–æ–≤–∫–µ:**

```text
Authorization: Token XYZ
```

‚ùó –≠—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫. –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —Ä–µ—à–∞—é—Ç —Å–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏!

- [x] –ó–∞–ª–æ–≥–∏–Ω—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ https://demo.realworld.io/
- [x] –ù–∞–π–¥–∏ –¥–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ XHR –∑–∞–ø—Ä–æ—Å–∞—Ö.
- [x] –ù–∞–ø–∏—à–∏ —Ç–µ—Å—Ç –¥–ª—è –µ–Ω–¥–ø–æ–π–Ω—Ç–∞ `GET /user`

***

- [x] –ü—Ä–∏–≤–µ–¥–∏ —Å–≤–æ–π –∫–æ–¥ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å [—ç—Ç–∞–ª–æ–Ω–æ–º](/cypress/integration/test-api.spec.js#L123)

–¢–∞ –¥–∞ ü•≥ –¢—ã –¥–æ—à–µ–ª –¥–æ –∫–æ–Ω—Ü–∞.

# üò≠ –î–æ–º–∞—à–∫–∞

–ù–∞–ø–∏—à–∏ –ø–æ **1 –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–º—É** –∏ –ø–æ **2 –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö** —Ç–µ—Å—Ç–∞ –Ω–∞ API –¥–ª—è —Ñ–∏—á–µ–π:
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏.
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—å–∏.
- [ ] –£–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—å–∏.
- [ ] –í—ã—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

# –§–∏–¥–±–µ–∫ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ üôè

<import from="/partials/tutorial_feedback.md"></import>

# –ß–∏—Ç–∞—Ç—å –∏ —Å–º–æ—Ç—Ä–µ—Ç—å

1. [–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –Ω–∞ API](https://habr.com/ru/post/599127/)
2. [–ë–∞–≥–∏ –≤ API –•–∞–±—Ä–∞ –∏–ª–∏ 500 ‚Äì —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ?](https://habr.com/ru/post/647957/)
3. [–ê–≤—Ç–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —Å –ø–æ–º–æ—â—å—é –ò–ò](https://www.youtube.com/watch?v=NP6LL5e52vU)
